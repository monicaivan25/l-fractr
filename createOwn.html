<!DOCTYPE html>
<html lang="en">
<head>
	<title>Create your own</title>
	<meta charset="UTF-8">
	<link rel="stylesheet" href="style.css">
	<link rel="stylesheet" href="styleOwn.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	<script src="https://www.gstatic.com/firebasejs/5.5.9/firebase.js"></script>
	<!-- <script src="createOwn.js"></script> -->

</head>
<body>
	<div class="wrapper">
		<aside>
			<div class="asideItem" id="asit1">
				<p class="myh1">Starting Position</p>
				<p class="myh2">click on the canvas to set</p>
				<p class="myh1">312,223</p>
			</div>
			<div class="asideItem" id="asit2">
				<p class="myh1">Number of iterations</p>
				<div>					
					<input type='radio' value='1' name='radio' id='radio1'/>
					<label for='radio1'> 1 </label>

					<input type='radio' value='2' name='radio' id='radio2'/>
					<label for='radio2'> 2 </label>

					<input type='radio' value='3' name='radio' id='radio3'/>
					<label for='radio3'> 3 </label>

					<input type='radio' value='4' name='radio' id='radio4'/>
					<label for='radio4'> 4 </label>

					<input type='radio' value='5' name='radio' id='radio5'/>
					<label for='radio5'> 5 </label>

					<input type='radio' value='6' name='radio' id='radio6'/>
					<label for='radio6'> 6 </label>

					<input type='radio' value='7' name='radio' id='radio7'/>
					<label for='radio7'> 7 </label>
				</div>
			</div>
			<div class="asideItem" id="asit3">
				<p class="myh1">Angles</p>
				<div style="display: grid; grid-template-columns: 50% 50%; grid-template-rows: auto">
					<p class="myh2">Starting: </p>
					<div class="anglesInput">
						<input type="text" class="smallInput" id="startDegree"/>
					</div>
				</div>
				<div style="height:3px"></div>
				<div style="display: grid; grid-template-columns: 50% 50%; grid-template-rows: auto">
					<p class="myh2">Incrementing: </p>
					<div class="anglesInput"> 
						<input type="text" class="smallInput" id="incrDegree"/>
					</div>
				</div>
			</div>
			<div class="asideItem" id="asit4">
				<p class="myh1">Axiom</p>
				<div class="axrule">
					<input type="text" id="axiom"/>
				</div>
			</div>
			<div class="asideItem" id="asit5">
				<p class="myh1">Rules</p>
				<div>
					<div class="anglesInput" id="rulesSmall">
						<input type="text" class="smallInput" id="literal"/>
					</div>
					<span id="eq" style="color: white;">=</span>
					<div class="axrule">
						<input type="text" id="rule"/></div>
					</div>
					<div style="height:8px"></div>
					<button id="addbutton">Add</button>
				</div>
				<div class="asideItem" id="asit6">
					<p class="myh1">Render</p>
				</div>

				

			</aside>
			<main class="canvas">

			</main>
		</div>
		<!--bottom buttons -->
		<a href="index.html" class="bottom-button fa fa-home " id="home"></a>
		<span id="loginbtn" class="fa fa-fire bottom-button" onclick="document.getElementById('login-form').style.display='block'" style="width:auto;"></span>
		<span id="savebtn" class="fa fa-download bottom-button" ></span>

		<!--Login modal-->
		<div id="login-form" class="modal">

			<form class="modal-content">

				<div class="container">
					<input type="text" class="field" placeholder="Enter Email" id="txtEmail" required>
					<input type="password" class="field" style="width:100%" placeholder="Enter Password" id="textPsw" required>

					<button type="button" id="login" class="formbtn">Log In</button>
					<button type="button" id="logout" class="formbtn">Log out</button>
					<button type="button" id="signup" class="formbtn">Sign Up</button>
					<button type="button" onclick="document.getElementById('login-form').style.display='none'" class="formbtn">Cancel</button>
					
				</div>
			</form>
		</div>


		<script>
			  // Initialize Firebase
			  var config = {
			  	apiKey: "AIzaSyAZxvFhAhfPt__c6jb1aLTUM8jhdzD44eg",
			  	authDomain: "l-fractr.firebaseapp.com",
			  	databaseURL: "https://l-fractr.firebaseio.com",
			  	projectId: "l-fractr",
			  	storageBucket: "l-fractr.appspot.com",
			  	messagingSenderId: "480520325235"
			  };
			  firebase.initializeApp(config);

			  const modal = document.getElementById('login-form');
			  const txtEmail = document.getElementById("txtEmail");
			  const textPsw = document.getElementById("textPsw");
			  const loginBtn = document.getElementById("login");
			  const signupBtn = document.getElementById("signup");
			  const logoutBtn = document.getElementById("logout");

			  function exitModal(){
			  	modal.style.display = 'none';
			  	txtEmail.value='';
			  	textPsw.value='';
			  }

			  function validateEmail(inputText)
			  {
			  	var mailformat = /^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;
			  	if(inputText.match(mailformat))
			  	{
			  		return true;
			  	}
			  	else
			  	{
			  		alert("You have entered an invalid email address!");
			  		return false;
			  	}
			  }

			  loginBtn.addEventListener('click', e => {
			  	console.log("login")
			  	const email = txtEmail.value;
			  	const pass = textPsw.value;
			  	const auth = firebase.auth();
			  	if(validateEmail(email))
			  	{
			  		const promise = auth.signInWithEmailAndPassword(email, pass);
			  		promise.catch(e => console.log(e.message));
			  		exitModal();
			  	}
			  });
			  
			  signupBtn.addEventListener('click', e =>{
			  	console.log("signup")
			  	const email = txtEmail.value;
			  	const pass = textPsw.value;
			  	const auth = firebase.auth();
			  	if(validateEmail(email))
			  	{
			  		const promise =  auth.createUserWithEmailAndPassword(email, pass);
			  		promise.catch(e => console.log(e.message));
			  		exitModal();
			  	}
			  });

			  logoutBtn.addEventListener('click', e => {
			  	console.log('logout');
			  	firebase.auth().signOut();
			  	exitModal();
			  });

			  firebase.auth().onAuthStateChanged(firebaseUser => {
			  	if(firebaseUser){
			  		console.log(firebaseUser);
			  		logoutBtn.style.display = 'block';
			  		loginBtn.style.display = 'none';
			  		signupBtn.style.display = 'none';
			  	} else {
			  		console.log('not logged in');
			  		logoutBtn.style.display = 'none';
			  		loginBtn.style.display = 'block';
			  		signupBtn.style.display = 'block';
			  	}
			  })

			</script>
		</body>
		</html>